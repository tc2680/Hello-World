<html>
    <head>
    <script type='text/javascript' src='https://www.google.com/jsapi'></script>
    
    <!--*************************************************
    *   hide/show for next section of presentation
    *************************************************-->
    <script type="text/javascript">
        function changeShowHide(obj) {
            var fold_image = new Array();
            if (document.getElementById(obj).style.display == 'none') {
                document.getElementById(obj).style.display = 'block';
                if (document.getElementById('nfolding')) {
                    document.getElementById('nfolding').src = fold_image[0];
                }
            } else {
                document.getElementById(obj).style.display = 'none'; Ã¥
                if (document.getElementById('nfolding')) {
                    document.getElementById('nfolding').src = fold_image[1];
                }
            }
        } 
    </script>
    </head>
   
    <body>
    
    <table align="center" style="width: 800px;" border="0">
        <tr><td align="center"><h2>EDAV Project 2014</h2></td></tr></table>
    
    <!--*******************************************************
    *   Second Idea: data visualization
    *******************************************************-->
	    <script type="text/javascript">
        /****************************************************
         *  load google chart package
         *****************************************************/
        google.load('visualization', '1', { 'packages': ['motionchart'] });
        google.setOnLoadCallback(drawVisualization);
        
        /****************************************************
         *  define dataset from google docs
         *****************************************************/
        function drawVisualization() {
            var query = new google.visualization.Query(
                'https://docs.google.com/spreadsheets/d/1q1z5HQ2bPssTR24viT5Yt-GD3Yxp6ZLIW0Z9AIGlIyM/edit#gid=1755359768');
                
            // Sample query
            //query.setQuery("SELECT A, B, C, D, E WHERE (A='something' OR B='something') ORDER BY A, B ");
            query.setQuery("SELECT A, B, C, D, E ORDER BY A, B");
            
            // Send the query with a callback function
            query.send(handleQueryResponse);
        }

        function handleQueryResponse(response) {
            if (response.isError()) {
                alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
                return;
            }

            /****************************************************
             *  add columns from the spreadsheet
             *****************************************************/
            var numRow = response.getDataTable().getNumberOfRows();
            var remoteDatatable = response.getDataTable();
            var data = new google.visualization.DataTable();
            data.addColumn('string', 'Portfolio');
            data.addColumn('date', 'Study Year');
            data.addColumn('number', 'Return on Investment $');
            data.addColumn('number', 'Return on Investment %');
            data.addColumn('string', 'Investment Model');
            //alert(numRow) // debug
            //alert(remoteDatatable.getValue(0,0)) // debug
            //alert(response.getDataTable().getValue(0,0)) // debug
    
            /****************************************************
             *  loop through all records in the spreadsheet
             *  and add them to the data array
             *****************************************************/
            for (var i = 0; i < numRow; i++) {
                var portfolio = remoteDatatable.getValue(i, 0) // 1st column
                var study_year = remoteDatatable.getValue(i, 1) // 2nd column
                var roi_dollar = remoteDatatable.getValue(i, 2) // 3rd column
                var roi_percent = remoteDatatable.getValue(i, 3) // 4th column
                var investment_model = remoteDatatable.getValue(i, 4) // 5th column
                data.addRows([
                    [portfolio, study_year, roi_dollar, roi_percent, investment_model]
                ]);
            }

            /****************************************************
             *  initialize chart component
             ****************************************************/
            var chart = new google.visualization.MotionChart(document.getElementById('chart_div_portfolio_roi'));
            var options = {};
            options['state'] = 			'{"xLambda":1,"playDuration":15088.88888888889,"orderedByY":false,"iconKeySettings":[],"orderedByX":false,"iconType":"BUBBLE","dimensions":{"iconDimensions":["dim0"]},"xZoomedDataMin":694137600000,"uniColorForNonSelected":false,"time":"1991-12-31","xZoomedDataMax":1388448000000,"xZoomedIn":false,"showTrails":false,"duration":{"multiplier":1,"timeUnit":"D"},"yZoomedDataMin":127770,"nonSelectedAlpha":0.4,"yZoomedIn":false,"xAxisOption":"_TIME","colorOption":"4","yZoomedDataMax":1114870,"yLambda":1,"sizeOption":"2","yAxisOption":"2"} ';
			
			
            options['width'] = '800';
            options['height'] = '450';
            //options['showAdvancedPanel'] = false
            chart.draw(data, options);
            //chart.draw(data, { width: 800, height: 400 });
        }
    </script>
	
    <table border="0" align="center" style="width: 900px; height: 550px"><tr><td>
        <div id="chart_div_portfolio_roi"></div>
    </td></tr></table>

	</body>
</html>